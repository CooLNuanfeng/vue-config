(function(a,b){a.ui.navigator.register(function(){return{pluginName:"iscroll",_init:function(){return this._adjustHtml()._reBindEvent()._initOrg()},_reBindEvent:function(){var c=this,d=c._data;d.isScrollToNext=d.isScrollToNext===b?true:d.isScrollToNext;d.isShowShadow=d.isShowShadow===b?true:d.isShowShadow;c._loadIscroll();a(window).on("ortchange",a.proxy(c._ortChangeHandler,c));c.on("destroy",function(){a(window).off("ortchange",c._ortChangeHandler);d.iScroll.destroy()});return c},_adjustHtml:function(){var f=this,g=f._data,e=f.root().addClass("ui-navigator"),i=e.find("ul"),h=e.find(".ui-navigator-wrapper"),c=i.find("li"),d=[0];!h.length&&i.wrap('<div class="ui-navigator-wrapper"></div>');i.find("li").each(function(j){d[j]=j?(d[j-1]+this.offsetWidth):(d[j]+this.offsetLeft-i[0].offsetLeft+this.offsetWidth)});a.extend(g,{_$navWrapper:e.find(".ui-navigator-wrapper"),_$navScroller:i.width(d[c.length-1]),_$navList:c,_scrollerNum:c.length,_scrollerSumWidth:d,_$fixElemLeft:e.find(".ui-navigator-fixleft"),_$fixElemRight:e.find(".ui-navigator-fixright")});return f},_loadIscroll:function(){var c=this,d=c._data;d.iScroll=iScroll(d._$navWrapper.get(0),d.iScrollOpts=a.extend({hScroll:true,vScroll:false,hScrollbar:false,vScrollbar:false},d.iScrollOpts,{onScrollStart:function(f){c.trigger("scrollstart",f)},onScrollMove:function(f){c.trigger("scrollmove",f)},onScrollEnd:function(f){d.isShowShadow&&c._setShadow();c.trigger("scrollend",f)}}));return c},_setShadow:function(){var e=this,f=e._data,g=f._$navWrapper,d={left:"ui-navigator-shadowl",right:"ui-navigator-shadowr",all:"ui-navigator-shadowall"},h=f.iScroll,c=h.x;if(c<0){g.removeClass(d.left+" "+d.right).addClass(d.all);if(c<=h.maxScrollX){g.removeClass(d.all+" "+d.right).addClass(d.left)}}else{g.removeClass(d.all+" "+d.left);h.hScroll?g.addClass(d.right):g.removeClass(d.all+" "+d.left+" "+d.right)}return e},_scrollToNext:function(d,h){var e=this,f=e._data,c=f._scrollerSumWidth,g=f.iScroll;g.scrollTo(h=="last"?g.wrapperW-(c[d+1]||c[c.length-1]):h=="first"?(-c[d-2]||0):g.x,0,400);return e},_getPos:function(f){var h=this,e=h._data,l=e.iScroll,k=Math.abs(l.x)||0,i=e._scrollerSumWidth,j=e._$navList,m=i[f]-k,g=i[(f-1)||0]-k,c=(i[f+1]||i[i.length-1])-k,d=l.wrapperW;return(m>=d||c>d)?"last":(m<=j[f].offsetWidth||g<j.eq(f-1)[0].offsetWidth)?"first":"middle"},_ortChangeHandler:function(){var c=this,d=c._data,e=d.iScroll;e.refresh();c._setShadow();d._$navWrapper.width(e.wrapperW-e.wrapperOffsetLeft)},switchTo:function(f,d,i){var g=this,h=g._data;g.switchToOrg(f,d,i);if(!h._$tabList.eq(f).hasClass("ui-navigator-fix")){var c=h._$fixElemLeft,f=f-(c.length?c.length:0),j=g._getPos(f);d&&h.isShowShadow&&g._setShadow();h.isScrollToNext&&g._scrollToNext(f,j)}return g}}})})(Zepto);
(function(b){b.ui.calendar.register(function(){return{pluginName:"picker",_create:function(){var c=this.root();if(!c){throw new Error("\u8bf7\u6307\u5b9a\u65e5\u671f\u9009\u62e9\u5668\u7684\u8d4b\u503c\u5bf9\u8c61")}},_init:function(){var c=this.root(),d=this._data;this._container=b("<div></div>");d.date||(d.date=c[c.is("select, input")?"val":"text"]());this._initOrg();b(window).on("ortchange",b.proxy(this._eventHandler,this));this.on("commit",function(g,f){var h=b.calendar.formatDate(f);c[c.is("select, input")?"val":"text"](h)})},_eventHandler:function(c){if(c.type==="ortchange"){this._frame&&this._frame.refresh()}else{this._eventHandlerOrg(c)}},show:function(){var d=this,c;if(this._visible){return this}c=this._container;this._visible=true;this.refresh();this._frame=a(c,function(f){var e;if(f){e=d._option("selectedDate");d.trigger("commit",[e,b.calendar.formatDate(e),d]);d._option("date",e)}else{d._option("selectedDate",d._option("date"))}d.hide();return false});return this.trigger("show",this)},hide:function(){var d=this,c;if(!this._visible){return this}c=b.Event("beforehide");this.trigger(c,this);if(c.isDefaultPrevented()){return this}this._visible=false;this._frame.close(function(){d.trigger&&d.trigger("hide")});this._frame=null;return this},destroy:function(){b(window).off("ortchange",this._eventHandler);this._frame&&this._frame.close();return this.destroyOrg()}}});function a(c,g){var j=b('<span class="ui-holder"></span>'),k=b('<div class="ui-slideup-wrap">   <div class="ui-slideup">       <div class="header">           <span class="ok-btn">\u786e\u8ba4</span>           <span class="no-btn">\u53d6\u6d88</span>       </div>       <div class="frame"></div>   </div></div>'),e=b(".ui-slideup",k),f=b(".frame",e),h={refresh:function(l){k.css({top:window.pageYOffset+"px",height:window.innerHeight+"px"});e.animate({translateY:"-"+e.height()+"px",translateZ:"0"},400,"ease-out",function(){l&&l.call(h)});return h},close:function(m){var l=a.count=a.count-1;k.off("click.slideup"+d);e.animate({translateY:"0",translateZ:"0"},200,"ease-out",function(){m&&m();j.replaceWith(c);k.remove();l===0&&b(document).off("touchmove.slideup")}).find(".ok-btn, .no-btn").highlight();return h}},d=a.id=(a.id>>>0)+1,i;f.append(c.replaceWith(j));i=a.count=(a.count>>>0)+1;i===1&&b(document).on("touchmove.slideup",function(l){l.preventDefault()});k.on("click.slideup"+d,".ok-btn, .no-btn",function(){g.call(h,b(this).is(".ok-btn"))!==false&&h.close()}).appendTo(document.body).find(".ok-btn, .no-btn").highlight("ui-state-hover");h.refresh();return h}})(Zepto);
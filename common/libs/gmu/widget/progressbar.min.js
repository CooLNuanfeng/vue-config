(function(a,b){a.ui.define("progressbar",{_data:{initValue:0,horizontal:true,transitionDuration:300,_isShow:true,_current:0,_percent:0},_create:function(){var c=this,d=c.data("horizontal")?"h":"v";(c.root()||c.root(a("<div></div>"))).addClass("ui-progressbar-"+d).appendTo(c.data("container")||(c.root().parent().length?"":document.body)).html(('<div class="ui-progressbar-bg"><div class="ui-progressbar-filled"></div><div class="ui-progressbar-button"><div><b></b></div></div></div>'))},_setup:function(c){c||this._create()},_init:function(){var g=this,d=g.root(),f=a.proxy(g._eventHandler,g),h=d.find(".ui-progressbar-button"),c=d.find(".ui-progressbar-bg"),e=d.offset();h.on("touchstart touchmove touchend touchcancel",f);c.on("touchstart",f);g.data({_button:h[0],$_background:c,_filled:d.find(".ui-progressbar-filled")[0],_width:e.width,_height:e.height});g.data("horizontal")&&e.width&&d.width(e.width);g.data("initValue")>0&&g.value(g.data("initValue"))},_eventHandler:function(d){var c=this;switch(d.type){case"touchmove":c._touchMove(d);break;case"touchstart":a(d.target).hasClass("ui-progressbar-bg")?c._click(d):c._touchStart(d);break;case"touchcancel":case"touchend":c._touchEnd();break;case"tap":c._click(d);break}},_touchStart:function(d){var c=this,f=c._data;c.data({pageX:d.touches[0].pageX,pageY:d.touches[0].pageY,S:false,T:false,X:0,Y:0});f._button.style.webkitTransitionDuration="0ms";f._filled.style.webkitTransitionDuration="0ms";a(f._button).addClass("ui-progressbar-button-pressed");c.trigger("dragStart")},_touchMove:function(g){var f=this,i=f._data,k=g.touches[0],j=k.pageX-i.pageX,h=k.pageY-i.pageY,c;if(!i.T){var d=Math.abs(j)<Math.abs(k.pageY-i.pageY);i.T=true;i.S=d}if(i.horizontal){if(!i.S){g.stopPropagation();g.preventDefault();c=(j+i._current)/i._width*100;if(c<=100&&c>=0){i._percent=c;i.X=j;i._button.style.webkitTransform="translate3d("+(i.X+i._current)+"px,0,0)";i._filled.style.width=c+"%";f.trigger("valueChange")}f.trigger("dragMove")}}else{if(i.S){g.stopPropagation();g.preventDefault();c=-(i._current+h)/i._height*100;if(c<=100&&c>=0){i._percent=c;i.Y=h;i._button.style.webkitTransform="translate3d(0,"+(h+i._current)+"px,0)";i._filled.style.cssText+="height:"+c+"%;top:"+(i._height+h+i._current)+"px";f.trigger("valueChange")}f.trigger("dragMove")}}},_touchEnd:function(){var c=this,d=c._data;d._current+=d.horizontal?d.X:d.Y;a(d._button).removeClass("ui-progressbar-button-pressed");c.trigger("dragEnd")},_click:function(f){var d=this,g=d._data,c=g.$_background.offset(),h=f.touches[0];g.horizontal?d.value((h.pageX-c.left)/g._width*100):d.value((g._height-h.pageY+c.top)/g._height*100)},value:function(e){var d=this,g=d._data,c,f;if(e===b){return g._percent}else{e=parseFloat(e);if(isNaN(e)){return d}e=e>100?100:e<0?0:e;g._percent=e;f=";-webkit-transition-duration:"+g.transitionDuration+"ms";if(g.horizontal){c=g._current=g._width*e/100;g._button.style.cssText+="-webkit-transform:translate3d("+c+"px,0,0)"+f;g._filled.style.cssText+="width:"+e+"%"+f}else{c=g._current=g._height*e/-100;g._button.style.cssText+="-webkit-transform:translate3d(0,"+c+"px,0)"+f;g._filled.style.cssText+="height:"+e+"%;top:"+(g._height+c)+"px"+f}d.trigger("valueChange");return d}},show:function(){var c=this;if(!c.data("_isShow")){c.root().css("display","block");c.data("_isShow",true)}return c},hide:function(){var c=this;if(c.data("_isShow")){c.root().css("display","none");c.data("_isShow",false)}return c}})})(Zepto);
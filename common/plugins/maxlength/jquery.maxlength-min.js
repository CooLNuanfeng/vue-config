(function(a){a.fn.maxlength=function(b){if(typeof b=="string"){b={callback:b}}b=a.extend({limit:true,desc:true,trim:true,chinese:false,callback:".charsLeft"},b);function c(d){var e=b.trim?a.trim(d.value):d.value;if(!b.chinese){return e.length}else{return e.replace(/[^\x00-\xff]/g,"**").length}}return this.each(function(){var i=this,h=a(i),j=a(document),g=h.closest("form"),f=h.attr("data-maxlength")||h.attr("maxlength"),k=g.find(b.callback);if(f==undefined){return}var e=function(n){var l=c(this),o=l>=f,m=n.keyCode;if(!o){return}switch(m){case 8:case 9:case 17:case 36:case 35:case 37:case 38:case 39:case 40:case 46:case 65:return;default:return m!=32&&m!=13&&l==f}};var d=function(){if(this.count){clearTimeout(this.count)}this.count=setTimeout(function(){var l=c(i);var n=l-h.val().length;var m=f-l;if(n>0){h.attr("maxlength",f-n)}if(b.desc){k.html(m>0?m:"0")}else{k.html(m>0?l:f)}},100)};h.on("keyup change",d);if(b.limit){h.keydown(e)}d()})}})(jQuery);
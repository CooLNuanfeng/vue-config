(function(n){function t(t,i){function tt(){return g.update(),rt(),g}function it(){var n=w.toLowerCase();f.obj.css(h,u/s.ratio),r.obj.css(h,-u),y.start=f.obj.offset()[h],s.obj.css(n,e[i.axis]),e.obj.css(n,e[i.axis]),f.obj.css(n,f[i.axis])}function rt(){b?o.obj[0].ontouchstart=function(n){1===n.touches.length&&(nt(n.touches[0]),n.stopPropagation())}:(f.obj.bind("mousedown",nt),e.obj.bind("mouseup",p)),i.scroll&&window.addEventListener?(l[0].addEventListener("DOMMouseScroll",d,!1),l[0].addEventListener("mousewheel",d,!1),l[0].addEventListener("MozMousePixelScroll",function(n){n.preventDefault()},!1)):i.scroll&&(l[0].onmousewheel=d)}function nt(t){n("body").addClass("noSelect");var i=parseInt(f.obj.css(h),10);y.start=a?t.pageX:t.pageY,c.start=i=="auto"?0:i,b?(document.ontouchmove=function(n){n.preventDefault(),p(n.touches[0])},document.ontouchend=v):(n(document).bind("mousemove",p),n(document).bind("mouseup",v),f.obj.bind("mouseup",v))}function d(t){if(r.ratio<1){var e=t||window.event,c=e.wheelDelta?e.wheelDelta/120:-e.detail/3;u-=c*i.wheel,u=Math.min(r[i.axis]-o[i.axis],Math.max(0,u)),f.obj.css(h,u/s.ratio),r.obj.css(h,-u),(i.lockscroll||u!==r[i.axis]-o[i.axis]&&u!==0)&&(e=n.event.fix(e),e.preventDefault());i.onScroll(k,u/s.ratio)}}function p(n){if(r.ratio<1){c.now=i.invertscroll&&b?Math.min(e[i.axis]-f[i.axis],Math.max(0,c.start+(y.start-(a?n.pageX:n.pageY)))):Math.min(e[i.axis]-f[i.axis],Math.max(0,c.start+((a?n.pageX:n.pageY)-y.start))),u=c.now*s.ratio,r.obj.css(h,-u),f.obj.css(h,c.now);i.onScroll(k,c.now)}}function v(){n("body").removeClass("noSelect"),n(document).unbind("mousemove",p),n(document).unbind("mouseup",v),f.obj.unbind("mouseup",v),document.ontouchmove=document.ontouchend=null}var g=this,l=t,o={obj:n(".viewport",t)},r={obj:n(".overview",t)},s={obj:n(".scrollbar",t)},e={obj:n(".track",s.obj)},f={obj:n(".thumb",s.obj)},a=i.axis==="x",h=a?"left":"top",w=a?"Width":"Height",u=0,c={start:0,now:0},y={},b="ontouchstart"in document.documentElement,k={getWrapper:l,getTrack:e,getThumb:f};return this.update=function(n,t){if(o[i.axis]=o.obj[0]["offset"+w],r[i.axis]=r.obj[0]["scroll"+w],r.ratio=o[i.axis]/r[i.axis],s.obj.toggleClass("disable",r.ratio>=1),e[i.axis]=i.size==="auto"?o[i.axis]:i.size,f[i.axis]=Math.min(e[i.axis],Math.max(0,i.sizethumb==="auto"?e[i.axis]*r.ratio:i.sizethumb)),s.ratio=i.sizethumb==="auto"?r[i.axis]/e[i.axis]:(r[i.axis]-o[i.axis])/(e[i.axis]-f[i.axis]),u=n==="relative"&&r.ratio<=1?Math.min(r[i.axis]-o[i.axis],Math.max(0,u)):0,u=n==="bottom"&&r.ratio<=1?r[i.axis]-o[i.axis]:isNaN(parseInt(n,10))?u:parseInt(n,10),it(),t)i.onScroll(k,u/s.ratio)},tt()}n.tiny=n.tiny||{},n.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1,onScroll:n.noop}},n.fn.tinyscrollbar=function(i){var r=n.extend({},n.tiny.scrollbar.options,i);return this.each(function(){n(this).data("tsb",new t(n(this),r))}),this},n.fn.tinyscrollbar_update=function(t,i){return n(this).data("tsb").update(t,i)}})(jQuery)
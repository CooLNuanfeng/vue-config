(function(b){var a={init:function(c){var d={opacity:0.2,color:"#666666",stepx:10,stepy:10,fillImg:"",mousedown:true,beginMove:b.noop,supportIrisMode:false,overCompleted:b.noop,callCallbackPerc:false,callbackFunction:null};return this.each(function(k){var f=b(this);var l=f.height();var r=f.width();var m=f.position();var q=m.left;var p=m.top;var e=(f.attr("name")||f.attr("id")||f.attr("class")||"internalName")+"__sc";var g=spritey=0;var o=0;if(c){b.extend(d,c)}var s=(r/d.stepx)*(l/d.stepy);var n=s*d.callCallbackPerc/100;over="";for(k=0;k<r;k+=d.stepx){for(j=0;j<l;j+=d.stepy){over+="<div class='"+e+"' style='height:"+d.stepy+"px; width:"+d.stepx+"px; position: absolute; z-index:99;border: 0;overflow: hidden;top:"+(p+j)+"px; left:"+(q+k)+"px; background:";if(d.fillImg){over+=" transparent url("+d.fillImg+") -"+g+"px -"+spritey+"px no-repeat;";spritey+=d.stepy}else{over+=d.color+";"}over+="'/>"}if(d.fillImg){spritey=0;g+=d.stepx}}f.after(over);setTimeout(function(){d.overCompleted.call(f)},250);b("."+e).mouseover(function(){d.beginMove.call();if(d.mousedown==false||f.data("okMouse")){op=b(this).css("opacity")-d.opacity;if(d.callCallbackPerc!=false&&(s--<n)){b("."+e).remove();d.callbackFunction()}if(op<=0){b(this).remove()}else{b(this).css({opacity:op})}}});if(d.supportIrisMode){b("."+e).mouseup(function(){d.beginMove.call();var i=b(this);var h=b("."+e);h.each(function(u,x){var z=b(x);var y=parseFloat(i.css("top"));var v=parseFloat(i.css("left"));var w=parseFloat(z.css("top"));var t=parseFloat(z.css("left"));if(((w+d.stepy==y||w-d.stepy==y)&&t==v)||((t+d.stepx==v||t-d.stepx==v)&&w==y)){z.animate({opacity:0},function(){b(this).remove();i.remove();if(d.callCallbackPerc!=false&&(s--<n)&&o==0){b("."+e).remove();d.callbackFunction();o=1}})}})})}if(d.mousedown){b("."+e).mousedown(function(){f.data("okMouse",true);return false}).mouseup(function(){f.data("okMouse",false);return false})}})}};b.fn.jScratchcard=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.jScratchcard")}}}})(jQuery);